/*
 * task.c
 *
 *  Created on: 2019. 6. 18.
 *      Author: jk.choi
 */
#include <stdio.h>
#include "task.h"
#include "util.h"
#include "modbus_hal.h"
#include "optic_qiagen.h"
#include "optic_service.h"
#include "Glob_Var_IF.h"
#define FALSE 0
#define TRUE 1
#define NULL (void *)0
#define PRE_COND_STEP  0
#define CYCLE_STEP 1

#define AGEING_TEST 0
#define EXTRACTION 0
#define OPTIC_ACTION 1
#define TEST 0

#define MACHINE_NUM 3

/* Motor action speed and step define */
#if MACHINE_NUM == 1
/* Ver1.0 1st machine */
#define PUMPSPEED	1600
#define INJECTSPEED	1600
#define PUMPING		1450
#define PUMPDELAY	(PUMPING * PUMPSPEED / 1000 + 200)
#define NEEDLESTEP	2000//3000	/* 1st 3000, 2nd 3500 */
#define PUMPSTEP	2000//2700	/* 1st 2700, 2nd 2950 */
#define VACCUMSTEP	870
#define MAGNETSTEP	4900	/* 1st 4900, 2nd 4600 */
#define SERINGUESTEP 5930	/* 1ST 5930, 2ND 5500*/
#define BEEDSTEP	2000//2650	/* 1st 2650, 2nd 2750 */
#define SMSPEED		800
#define OMSPEED		600
#define LYSISPUMP	1000
#define LYSISDELAY	(LYSISPUMP * PUMPSPEED / 1000 + 200)

#elif MACHINE_NUM == 2
/* Ver1.0 2nd machine */
#define PUMPSPEED	1600
#define INJECTSPEED	1600
#define PUMPING		1450
#define PUMPDELAY	(PUMPING * PUMPSPEED / 1000 + 200)
#define NEEDLESTEP	3500	/* 1st 3000, 2nd 3500 */
#define PUMPSTEP	2950	/* 1st 2700, 2nd 2950 */
#define VACCUMSTEP	870
#define MAGNETSTEP	4600	/* 1st 4900, 2nd 4600 */
#define SERINGUESTEP 5500	/* 1ST 5930, 2ND 5500*/
#define BEEDSTEP	2750	/* 1st 2650, 2nd 2750 */
#define SMSPEED		800
#define OMSPEED		600
#define LYSISPUMP	1000
#define LYSISDELAY	(LYSISPUMP * PUMPSPEED / 1000 + 200)

#elif MACHINE_NUM == 3
/* Ver2.0 machine 3rd */
#define PUMPSPEED	800
#define INJECTSPEED	1600
#define PUMPING		500
#define PUMPINGDELAY	(((PUMPING * PUMPSPEED) / 1000) + 200)
#define NEEDLESTEP	2750
#define NEEDLEDELAY	(((NEEDLESTEP * SMSPEED) / 1000) + 200)
#define PUMPSTEP	1400
#define PUMPDELAY	(((PUMPING * PUMPSPEED) / 1000) + 200)
#define VACCUMSTEP	860
#define VACCUMDELAY	(((VACCUMSTEP * SMSPEED) / 1000) + 200)
#define MAGNETSTEP	4500
#define MAGNETDELAY	(((MAGNETSTEP * SMSPEED) / 1000) + 200)
#define SERINGUESTEP 4700
#define BEEDSTEP	2750	/* 1st 2650, 2nd 2750 */
#define SMSPEED		800
#define OMSPEED		600
#define LYSISPUMP	540
#define LYSISDELAY	(((LYSISPUMP * PUMPSPEED) / 1000) + 200)
#define WASH_2	1600
#define WASH_2_DELAY	(((PUMPING * WASH_2) / 1000) + 200)

#else
/* Ver2.0 machine 4th */
#define PUMPSPEED	800
#define INJECTSPEED	1600
#define PUMPING		400
#define PUMPINGDELAY	(((PUMPING * PUMPSPEED) / 1000) + 200)
#define NEEDLESTEP	2750	/* 1st 3000, 2nd 3500 */
#define NEEDLEDELAY	(((NEEDLESTEP * SMSPEED) / 1000) + 200)
#define PUMPSTEP	1230
#define PUMPDELAY	(((PUMPSTEP * SMSPEED) / 1000) + 200)
#define VACCUMSTEP	950
#define VACCUMDELAY	(((VACCUMSTEP * SMSPEED) / 1000) + 200)
#define MAGNETSTEP	4520	/* 1st 4900, 2nd 4600 */
#define MAGNETDELAY	(((MAGNETSTEP * SMSPEED) / 1000) + 200)
#define SERINGUESTEP 4700	/* 1ST 5930, 2ND 5500*/
#define BEEDSTEP	2750	/* 1st 2650, 2nd 2750 */
#define SMSPEED		800
#define OMSPEED		600
#define LYSISPUMP	400
#define LYSISDELAY	(((LYSISPUMP * PUMPSPEED) / 1000) + 200)
#define WASH_2	1600
#define WASH_2_DELAY	(((PUMPING * WASH_2) / 1000) + 200)

#endif

/* Motor move direction */
#define UP		1
#define DOWN	0
#define CW		0
#define CCW		1
#define SMOOTHON	0
#define SMOOTHOFF	1

#define START_CMD	0xAE
#define STOP_CMD		0xCB
#define OPTIC_TEST_CMD	0x87
#define OPTIC_TEST1_CMD	0x88
#define OPTIC_TEST2_CMD	0x89

/* infinity aging test */
uint8_t infinity_start_stop_flag = FALSE;
extern uint8_t infinity_opt_flag;
uint8_t infinity_start_stop_flag_opt = FALSE;

uint8_t error_msg_flag = FALSE;		/* test 0416 */
uint8_t g_chamber_check_flag = FALSE;		/* test 200922 */
uint8_t g_ccw_flag = FALSE;		/* test add 201013*/
uint8_t g_cw_flag = FALSE;		/* test add 201013*/

int om_curr_position = 0;		// bjk 191029
int om_final_count;		// bjk 191029
extern uint16_t om_move_count;

extern uint8_t g_mod_flag;
extern uint8_t g_rountine_cnt;
extern uint8_t g_rountine_cnt_prev;

extern uint8_t g_optic1_tube_no;
extern uint8_t g_optic2_tube_no;

//extern stTransiveData recv_msg;
extern uint8_t g_temp_data_flag; 	/* TEST DATA 1010 */

// Add 2019.10.01
extern stTransiveData recv1_bytes;
extern stTransiveData recv1_msg;
extern stTransiveData send1_msg;
extern uint8_t recv1_msg_flag;

extern uint8_t ALLSTOP_flag;	// bjk 191107
/* Add 1015 */
extern uint8_t g_start_cmd_flag;
extern uint8_t g_stop_cmd_flag;
extern uint8_t g_start_resp_flag; 
extern uint8_t g_stop_resp_flag ; 

/* Add 1031 */
extern int g_optic_e1d1_value;
extern int g_optic_e2d2_value;

uint8_t g_optic_test_on_flag = FALSE;
uint8_t g_optic_test1_on_flag = FALSE;
uint8_t g_optic_test2_on_flag = FALSE;

uint8_t g_op_exe_flag = FALSE; // Add 2019.10.07
uint8_t g_op_mea_exe_flag = FALSE; // Add 2019.10.22
uint8_t g_fluosens_setting_flag = FALSE;
uint8_t g_optic_inited_flag = FALSE; // Add 2019.10.22

uint8_t g_data_start_flag = FALSE;  /* TEST DATA 1010 */

uint8_t*  gp_q_data;
uint8_t		Recv_buf[RECV_BUF_MAX] = {0};

stTaskOp*  p_task_sm_ops[SM_OPS_MAX]; 
stTaskOp*  p_task_om_ops;
stTaskOp*  p_task_opt_ops;  /* Add 1023 */
stTaskOp*  p_task_pel_ops;

stTaskType	task_desc[14];
//uint8_t g_optic_step = 0; /* Add 1030 */
uint8_t g_print_flag = FALSE; /* Add 1107 */

extern uint8_t temp_err_flag;
uint8_t temp_err_stop_flag = FALSE; /* 210205 add */

const stSeqDesc		diag_seq_desc[SEQ_DESC_IDX_MAX] = {
#if TEST
		{TASKID_SM2, 2000, SERINGUESTEP, SMSPEED, SMOOTHON, DOWN},
		{TASKID_SM4, 3800, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},

		{TASKID_OM, 3800, 2000, 800, 0, CCW},
		{TASKID_OM, 1300, 500, 800, 0, CW},
		{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 300, 2000, OMSPEED, 0, CW},
		{TASKID_SM1, 900, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
		{TASKID_SM2, VACCUMDELAY, 240, 9000, SMOOTHON, UP},
		{TASKID_SM1, 2200, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
		{TASKID_SM2, VACCUMDELAY, 240, SMSPEED, SMOOTHON, DOWN},	//tube4

		{TASKID_OM, 600, 1500, 300, 0, CCW},
		{TASKID_SM4, 600, 300, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OM, 300, 2000, 300, 0, CW},
		{TASKID_OM, 300, 500, 300, 0, CW},
		{TASKID_OM, 300, 500, 300, 0, CCW},
#if 0
		{TASKID_OM, 600, 1500, 300, 0, CCW},
		{TASKID_SM4, 600, 300, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OM, 300, 5050, 800, 0, CCW},
		{TASKID_OM, 3200, 500, 800, 0, CW},
		{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 300, 6300, OMSPEED, 0, CW},
		{TASKID_SM1, 3800, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
		{TASKID_SM2, VACCUMDELAY, 320, 4500, SMOOTHON, UP},
		{TASKID_SM1, 2200, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
		{TASKID_SM2, VACCUMDELAY, 320, SMSPEED, SMOOTHON, DOWN},	//tube1
		{TASKID_OM, 800, 6050, OMSPEED, 0, CCW},
		{TASKID_SM4, 3800, 300, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OM, 300, 6400, 800, 0, CW},	//zero position
		{TASKID_OM, 5000, 500, 800, 0, CW},
		{TASKID_OM, 500, 600, 800, 0, CCW},

		{TASKID_OM, 800, 3550, 800, 0, CW},
		{TASKID_OM, 2300, 500, 800, 0, CCW},
		{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 300, 3300, OMSPEED, 0, CCW},
		{TASKID_SM1, 2000, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
		{TASKID_SM2, VACCUMDELAY, 320, 4500, SMOOTHON, UP},
		{TASKID_SM1, 2200, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
		{TASKID_SM2, VACCUMDELAY, 320, SMSPEED, SMOOTHON, DOWN},	//tube3
		{TASKID_OM, 300, 3050, OMSPEED, 0, CW},
		{TASKID_SM4, 2000, 300, SMSPEED, SMOOTHON, DOWN},

		{TASKID_OM, 300, 5050, 800, 0, CW},
		{TASKID_OM, 3200, 500, 800, 0, CCW},
		{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 300, 7700, OMSPEED, 0, CCW},
		{TASKID_SM1, 4700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
		{TASKID_SM2, VACCUMDELAY, 320, 4500, SMOOTHON, UP},
		{TASKID_SM1, 2200, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
//		{TASKID_SM2, VACCUMDELAY, 240, SMSPEED, SMOOTHON, DOWN},	//tube2
//		{TASKID_OM, 300, 7550, OMSPEED, 0, CW},
//		{TASKID_SM4, 4700, 300, SMSPEED, SMOOTHON, DOWN},
//		{TASKID_OM, 300, 7800, 800, 0, CCW},
//		{TASKID_OM, 300, 500, 800, 0, CCW},
//		{TASKID_OM, 300, 500, 800, 0, CCW},
#endif


#endif
#if EXTRACTION	// Lysis
							/*START*/
				{TASKID_SM2, 2000, SERINGUESTEP, SMSPEED, SMOOTHON, DOWN},				/*Syringe Start Position*/
#if 1
				{TASKID_OM, 4000, 2250, OMSPEED, 0, CW},							/* Lysis */
				{TASKID_SM3, 1500, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},
//				{TASKID_OM, PUMPDELAY, 6750, OMSPEED, 0, CW},						/* Beed */
//				{TASKID_SM3, 4200, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
//				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_OM, PUMPDELAY, 2500, OMSPEED, 0, CCW},					/* Zero Position */
				{TASKID_SM3, 1800, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 7step start*/
				{TASKID_SM3, PUMPDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 1000, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, MAGNETDELAY, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
#endif
#if 1
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 15000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_SM3, 700, PUMPSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, PUMPDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*560*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 7step start*/
				{TASKID_SM3, PUMPDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 6step finish*/
				{TASKID_SM1, LYSISDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_OM, PUMPDELAY, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},							/* zero position */
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#if 0	//hole ccw 115
				{TASKID_SM4, 1000, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 12000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 1000, 5900, OMSPEED, 0, CCW},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 7step start*/
				{TASKID_SM3, PUMPDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 1300, 5900, OMSPEED, 0, CCW},
				{TASKID_OM, 3700, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},							/* zero position */
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#endif
#if EXTRACTION	// w1
				{TASKID_OM, MAGNETDELAY, 2250, OMSPEED, 0, CCW},
				{TASKID_SM3, 1400, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_OM, PUMPDELAY, 2400, OMSPEED, 0, CW},						/* Zero Position */
				{TASKID_SM3, 1400, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
#if 1
				{TASKID_SM4, 1000, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 19000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_SM3, 700, PUMPSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, PUMPDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*560*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, PUMPINGDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_OM, PUMPDELAY, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},							/* zero position */
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#if 0	//hole ccw 115
				{TASKID_SM4, 1000, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 19000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 1000, 5900, OMSPEED, 0, CCW},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 7step start*/
				{TASKID_SM3, PUMPDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 1300, 5900, OMSPEED, 0, CCW},
				{TASKID_OM, 3700, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},							/* zero position */
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#endif
#if EXTRACTION	// w2
				{TASKID_OM, MAGNETDELAY, 4500, OMSPEED, 0, CCW},
				{TASKID_SM3, 2700, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_OM, PUMPDELAY, 4700, OMSPEED, 0, CW},
				{TASKID_SM3, 3000, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Washing2 7step start*/
				{TASKID_SM3, PUMPDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, UP},
				{TASKID_SM3, WASH_2_DELAY, PUMPING, WASH_2, SMOOTHON, DOWN},/*Washing2 7step finish*/
#if 1
				{TASKID_SM4, 1000, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 19000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_SM3, 700, PUMPSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, PUMPDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*560*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, PUMPINGDELAY, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 1000, PUMPSTEP, SMSPEED, SMOOTHON, UP},

				{TASKID_OM, PUMPDELAY, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},							/* zero position */
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#if 0	//hole ccw 115
				{TASKID_SM4, 1000, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 19000, PUMPSTEP, SMSPEED, SMOOTHON, UP},				/*After 8sec*///
				{TASKID_OM, PUMPDELAY, 1375, OMSPEED, 0, CW},					/*Waste Basket 15+10 Open*/
				{TASKID_OM, 1000, 500, OMSPEED, 0, CCW},					/* 10 back */
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},					/*Magnet 5mm up*/
				{TASKID_OM, 300, 1000, OMSPEED, 0, CCW},						/* zero position */
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},				/*Waste Reject 1*/
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM1, 1200, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},				/*25ml*/
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 1000, 5900, OMSPEED, 0, CCW},

				{TASKID_SM3, PUMPDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Shaking 7step start*/
				{TASKID_SM3, PUMPDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, LYSISDELAY, LYSISPUMP, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, LYSISDELAY, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},			/*Shaking 6step finish*/
				{TASKID_OM, PUMPDELAY, 5750, OMSPEED, 0, CW},
				{TASKID_SM1, 3700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 1500, 9000, SMOOTHON, UP},
				{TASKID_SM1, 13600, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 1500, SMSPEED, SMOOTHON, DOWN},
				/* zero position */
				{TASKID_OM, 3300, 5900, OMSPEED, 0, CCW},
				{TASKID_OM, 3700, 875, OMSPEED, 0, CW},
				{TASKID_SM4, 650, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 450, 1000, OMSPEED, 0, CCW},
				{TASKID_OM, 650, 500, OMSPEED, 0, CCW},
				{TASKID_OM, 450, 500, OMSPEED, 0, CW},

				{TASKID_SM4, 450, MAGNETSTEP, SMSPEED, SMOOTHON, UP},
#endif
#endif
#if EXTRACTION	// elution
				{TASKID_SM2, 2000, SERINGUESTEP, SMSPEED, SMOOTHON, DOWN},

//				{TASKID_OM, MAGNETDELAY, 4500, OMSPEED, 0, CW},
//				{TASKID_SM3, 2800, PUMPSTEP, SMSPEED, SMOOTHON, DOWN},				/*Cylinder E Needle*/
//				{TASKID_SM3, PUMPDELAY, PUMPSTEP, SMSPEED, SMOOTHON, UP},
//				{TASKID_OM, PUMPDELAY, 4600, OMSPEED, 0, CCW},
#if 0
				{TASKID_SM3, 2800, PUMPSTEP, PUMPSPEED, SMOOTHON, DOWN},			/*Elution shaking 6step start*/
				{TASKID_SM3, PUMPDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM4, PUMPINGDELAY, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, MAGNETDELAY, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM4, PUMPINGDELAY, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM4, PUMPINGDELAY, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM4, PUMPINGDELAY, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM4, 300, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_SM3, 300, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM4, PUMPINGDELAY, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, 300, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, UP},
				{TASKID_SM3, PUMPINGDELAY, PUMPING, PUMPSPEED, SMOOTHON, DOWN},		/*Elution shaking 6step finish*/
#endif

#if 1	/* tube */
//				{TASKID_SM3, 12000, PUMPSTEP, PUMPSPEED, SMOOTHON, UP},

				{TASKID_SM4, 3800, MAGNETSTEP, SMSPEED, SMOOTHON, DOWN},

				{TASKID_OM, 3800, 2000, 800, 0, CCW},
				{TASKID_OM, 1300, 500, 800, 0, CW},
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_OM, 300, 2000, 800, 0, CW},
				{TASKID_SM1, 900, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 240, 9000, SMOOTHON, UP},
				{TASKID_SM1, 2200, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
//				{TASKID_SM2, VACCUMDELAY, 240, SMSPEED, SMOOTHON, DOWN},	//tube4

				{TASKID_OM, 600, 1500, 800, 0, CCW},
				{TASKID_SM4, 600, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 300, 2000, 800, 0, CW},
#if 0
				{TASKID_OM, 600, 1500, 300, 0, CCW},
				{TASKID_SM4, 600, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 300, 5000, OMSPEED, 0, CCW},
				{TASKID_OM, 3200, 500, OMSPEED, 0, CW},
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_OM, 300, 6300, OMSPEED, 0, CW},
				{TASKID_SM1, 3800, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 480, 9000, SMOOTHON, UP},
				{TASKID_SM1, 4500, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 480, SMSPEED, SMOOTHON, DOWN},	//tube1
				{TASKID_OM, 800, 6000, OMSPEED, 0, CCW},
				{TASKID_SM4, 3800, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 300, 6200, OMSPEED, 0, CW},	//zero position

				{TASKID_OM, 3800, 3500, OMSPEED, 0, CW},
				{TASKID_OM, 2300, 500, OMSPEED, 0, CCW},
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_OM, 300, 3200, OMSPEED, 0, CCW},
				{TASKID_SM1, 2000, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 480, 9000, SMOOTHON, UP},
				{TASKID_SM1, 4500, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 480, SMSPEED, SMOOTHON, DOWN},	//tube3
				{TASKID_OM, 300, 3000, OMSPEED, 0, CW},
				{TASKID_SM4, 2000, 300, SMSPEED, SMOOTHON, DOWN},

				{TASKID_OM, 300, 5050, OMSPEED, 0, CW},
				{TASKID_OM, 3200, 500, OMSPEED, 0, CCW},
				{TASKID_SM4, 400, 300, SMSPEED, SMOOTHON, UP},
				{TASKID_OM, 300, 7600, OMSPEED, 0, CCW},
				{TASKID_SM1, 4700, VACCUMSTEP, SMSPEED, SMOOTHON, DOWN},
				{TASKID_SM2, VACCUMDELAY, 480, 9000, SMOOTHON, UP},
				{TASKID_SM1, 4500, VACCUMSTEP, SMSPEED, SMOOTHON, UP},
				{TASKID_SM2, VACCUMDELAY, 480, SMSPEED, SMOOTHON, DOWN},	//tube2
				{TASKID_OM, 300, 7550, OMSPEED, 0, CW},
				{TASKID_SM4, 4700, 300, SMSPEED, SMOOTHON, DOWN},
				{TASKID_OM, 300, 7700, OMSPEED, 0, CCW},
#endif
				{TASKID_OM, 700, 500, 800, 0, CW},
				{TASKID_OM, 300, 500, 800, 0, CCW},
				{TASKID_SM4, 300, 60, SMSPEED, SMOOTHON, DOWN},

#endif

#endif
#if OPTIC_ACTION


				{TASKID_SM4, 1000, 1900, SMSPEED, SMOOTHON, DOWN},
				{TASKID_PEL, 1000, 9000, 600, 0, 1},
#endif

};

stSeqDesc		measure_seq_desc[MEA_SEQ_DESC_IDX_MAX] = {

		/* read 4 chamber */
#if OPTIC_ACTION

//Ver2.0
		/* cycle = 3 */
		{TASKID_SM4, 0, 0xFFFFFFF0, SMSPEED, SMOOTHON, UP},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//70
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 4 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//70
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 5 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//70
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 6 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//70
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 7 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 340, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 8 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 9 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 340, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 10 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 11 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 12 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 13 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 14 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},


		/* cycle = 15 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 16 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 17 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 18 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 19 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 20 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 21 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 22 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 23 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 24 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 25 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 26 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 27 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 28 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 29 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 30 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 31 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 32 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 33 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 34 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 35 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 36 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 37 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 38 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = 39 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

		/* cycle = 40 */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber1 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber2 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CCW},	// chamber3 -> 4
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},	//50
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, DIS_CONT, 0},

		/* cycle = FINAL */
		{TASKID_OPT, 0xFFFFFFF0, CHAM_4_1, 1, CONTINUE, 0},
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, UP},	//50
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber4 -> 3
		{TASKID_OPT, 0xFFFFFFF0, CHAM_3_4, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber3 -> 2
		{TASKID_OPT, 0xFFFFFFF0, CHAM_2_3, 1, CONTINUE, 0},
		{TASKID_OM, 0xFFFFFFF0, 4500, 400, 0, CW},	// chamber2 -> 1
		{TASKID_SM4, 0, 350, SMSPEED, SMOOTHON, DOWN},
		{TASKID_OPT, 0xFFFFFFF0, CHAM_1_2, 1, DIS_CONT, 0},

#endif
};

stOprInfo  	opr_ptr;
stOprInfo  	mea_opr_ptr;	/* Add 10.22 */
uint32_t 		timer_count;
stQueue   		job_queue;

uint8_t 		recv_msg_flag;
volatile uint32_t		task_ms_cnt = 0;
volatile uint32_t		ms_cnt;

uint8_t		peltier_step = PRE_COND_STEP;
uint8_t		g_toggle	= FALSE;

void delay(u16 x);

/**********************************************************************************
  * @function : task_init
  * @brief :  initialize tasks
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_init(void)
{
	uint16_t i;

	om_curr_position = 0;
	om_final_count = 0;
	om_move_count = 0;

//	drv_led_init_off();
	opr_ptr_init(&opr_ptr);
	opr_ptr_init(&mea_opr_ptr);

	for(i = TASKID_NONE + 1; i <= opr_ptr.task_max; i++)
	{
	        	task_desc[i].task_id    	= TASKID_NONE;
	        	task_desc[i].cycle_time 	= 0;
	        	task_desc[i].func       	= NULL;
	}

	/* Modify 191008 */
	task_regist( TASKID_COM_PC, 	10 , 	0,	task_com_pc );
	task_regist( TASKID_Q , 		5 , 	1,	task_q );
	task_regist( TASKID_SM1, 		10 ,	2, 	task_sm1 );
	task_regist( TASKID_SM2, 		10 ,	3, 	task_sm2 );
	task_regist( TASKID_SM3, 		10 ,	4, 	task_sm3 );
	task_regist( TASKID_SM4, 		10 ,	5, 	task_sm4 );
	task_regist( TASKID_SM5, 		10 ,	6, 	task_sm5 );
	task_regist( TASKID_OM, 		10 , 	7,	task_om );
	task_regist( TASKID_PEL, 		100 ,	8, 	task_pel );
	task_regist( TASKID_OPT, 		50 ,	9,	task_opt );		// 150 -> 50
	task_regist( TASKID_MNG, 		5 , 	10,	task_manage	);

	optic_qiagen_init();
}

static void init_TaskOp(stTaskOp *op)
{
	if(op != NULL)
	{
		op->job_status = JOB_READY;
		op->curr_value = 0;
		op->direction = 0;
		op->goal_value = 0;
		op->init_flag = 0;
		op->job_completed_flag = 0;
		op->job_index = 0;
		op->keep_time = 0;
		op->task_cycle = 0;
		op->task_id = 0;
	}
}

void task_Op_init(void)
{
	for(int i=0;i<SM_OPS_MAX; i++)
	{
		init_TaskOp(p_task_sm_ops[i]);
	}

	init_TaskOp(p_task_om_ops);
	init_TaskOp(p_task_opt_ops);
	init_TaskOp(p_task_pel_ops);
}

/**********************************************************************************
  * @function : task_run
  * @brief :  exexute the registered tasks
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_run(void)
{
	uint16_t i;
	static uint32_t ms_prev = 0;

	/* Modify 191008 */
	while(1)	
	{
	     	if(task_ms_cnt != ms_prev)
	     	{
			ms_prev = task_ms_cnt;
		
		    for( i = TASKID_NONE + 1; i <= opr_ptr.regist_task_cnt; i++)
			{
				if(  (task_ms_cnt -task_desc[i].offset_time) % task_desc[i].cycle_time == 0 )	
				{
					 task_desc[i].func();
				}
			}
		}
	}
}

/**********************************************************************************
  * @function : task_regist
  * @brief :  register a task to the task descriptor
  * @note :
  * @param : task id, cycle time, offset time, callback function
  * @retval : None
  *********************************************************************************/
void task_regist(E_TASK_ID task_id, uint32_t cycle_time, uint32_t offset_time , void (*task_func)())
{
	uint8_t i;
//	uint8_t task_max= 14;

	for( i = TASKID_NONE + 1; i <= opr_ptr.task_max; i++)
	{
       	if( task_desc[i].task_id  == TASKID_NONE)
		{
			 task_desc[i].task_id 		= task_id;
			 task_desc[i].func 		= task_func;
			 task_desc[i].cycle_time 	= cycle_time;
			 task_desc[i].offset_time 	= offset_time;

             opr_ptr.regist_task_cnt++;
         	 break;
		}
	}

}

/**********************************************************************************
  * @function : get_taskDesc
  * @brief :  search and return a task descriptor according to task id
  * @note :
  * @param : task id
  * @retval : task_desc
  *********************************************************************************/
stTaskType* get_taskDesc(E_TASK_ID task_id)
{
	uint16_t i;

	for(i = TASKID_NONE + 1; i < opr_ptr.task_max; i++)
	{	
		if(task_desc[i].task_id == task_id)
		{
			return &(task_desc[i]);
		}
	}

	return NULL;
}

/**********************************************************************************
  * @function : get_seqDesc
  * @brief :  get and return pointer of sequence descriptor
  * @note :
  * @param : job id
  * @retval : pseq_desc
  *********************************************************************************/
stSeqDesc* get_seqDesc(uint8_t job_id)
{
	stSeqDesc* pseq_desc;

	switch(job_id)
	{
		case START_CMD:
			pseq_desc = diag_seq_desc;
			break;

		case STOP_CMD:
			break;

		case MEASURE_OP_EVENT:
			pseq_desc = measure_seq_desc; /* Add 1022 */
			break;	

		default:
			pseq_desc = NULL;
			break;
	}

	return pseq_desc;
}


/**********************************************************************************
  * @function : task_q
  * @brief :  dequeue and execute the dequeued job
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_q(void)
{
	uint16_t job_id;
	stSeqDesc* pseq_desc_tmp;
	uint16_t i;
	uint8_t door_state;		/* 0402 test*/

	/* DeQueue */
	job_id = dequeue_job();

#if AGEING_TEST
	if(infinity_start_stop_flag == TRUE)
	{
		infinity_start_stop_flag = FALSE;
		job_id = STOP_CMD;
		infinity_start_stop_flag_opt = TRUE;
		g_op_exe_flag = TRUE;
	}
	if(infinity_opt_flag == TRUE)
	{
		infinity_opt_flag = FALSE;
		job_id = START_CMD;
	}
#endif
#if 0	/* 0402 door safety sensor code test*/
	door_state = door_sensor_check();

	if((door_state == OPEN) && (check_seq_compl() == FALSE))
	{
		if(error_msg_flag == FALSE)
		{
			error_msg_flag = TRUE;		/* test 0416 */
			EXTI_ClearITPendingBit(EXTI_Line8);
//			EXTI_ClearITPendingBit(EXTI_Line9);

			drv_pwm_all_stop();
			peltier_stop();
			peltier_ctrl_init_variables();

			printf("Error : Door is open state!! \n");
			g_op_exe_flag = TRUE;
		}
	}
#endif

	if(temp_err_flag == TRUE && temp_err_stop_flag == FALSE)
	{
		temp_err_flag = FALSE;
		temp_err_stop_flag = TRUE;
		drv_pwm_all_stop();
		peltier_stop();
		peltier_ctrl_init_variables();

		printf("Error : temp read error \n");
//		g_op_exe_flag = TRUE;
	}

	/* Get sequence description */
	switch(job_id)
	{
		case START_CMD:

			printf("start= %d\n", g_op_exe_flag);
			if((g_op_exe_flag != TRUE) /*&& (door_state == CLOSE)*/)
			{
				pseq_desc_tmp = get_seqDesc(job_id);
				opr_ptr.seq_desc_cnt = get_seq_cnt(pseq_desc_tmp); /* Add 1121 */

				/* assign pointer head of sequence description to the operation pointer */
				opr_ptr.seq_ptr_head = pseq_desc_tmp;
				opr_ptr.act_desc_idx = 0;
				opr_ptr.seq_ptr_curr = opr_ptr.seq_ptr_head + opr_ptr.act_desc_idx;
				opr_ptr.prev_start_time = 0;
				opr_ptr.job_assigned_flag |= TRUE;

				drv_inside_LED(OFF);	/* 201008 add */
				drv_water_fan(OFF);	/* 210114 test */
				g_op_exe_flag = TRUE;
			}
#if 0
			else if(door_state == OPEN)
			{
				EXTI_ClearITPendingBit(EXTI_Line8);
//				EXTI_ClearITPendingBit(EXTI_Line9);
//				printf("Warning : Close the door please.\n");
			}
#endif
			else
			{
				;
			}

			break;

		case STOP_CMD:
			printf("stop= %d\n", g_op_exe_flag);
			if( g_op_exe_flag == TRUE)
			{
				g_op_exe_flag = FALSE;
				error_msg_flag = FALSE;		/* test 0416 */
				temp_err_stop_flag = FALSE;		/* 210205 add */
				g_op_mea_exe_flag = FALSE;

				drv_pwm_all_stop();
				peltier_stop();
				variable_init();		/* bjk 0527 */

				opr_ptr.job_assigned_flag = FALSE;
				opr_ptr.seq_ptr_curr = opr_ptr.seq_ptr_head = NULL;
				opr_ptr.act_desc_idx = 0;
				opr_ptr.prev_start_time = 0;
				opr_ptr.seq_compld_flag = FALSE;
				
				for(i = 0; i < SEQ_DESC_IDX_MAX ; i++)
				{
					opr_ptr.seqact_compl_flags[i] = FALSE;
				}

				g_fluosens_setting_flag = FALSE;
				peltier_ctrl_init_variables();

				drv_motor_zero_position();
				task_init();
				task_Op_init();
			}

			break;

		case MEASURE_OP_EVENT: /* Add 1022 */

			if(g_op_mea_exe_flag != TRUE)
			{
				pseq_desc_tmp = get_seqDesc(job_id);
				mea_opr_ptr.seq_desc_cnt = get_seq_cnt(pseq_desc_tmp); /* Add 1121 */

//				printf("Q: MEASURE_OP_EVENT: job_id = %u, pseq_desc_tmp = %u\n", job_id, pseq_desc_tmp);

				/* assign pointer head of sequence description to the operation pointer */
				
				mea_opr_ptr.seq_ptr_head 	= pseq_desc_tmp;
				mea_opr_ptr.act_desc_idx 	= 0;
				mea_opr_ptr.seq_ptr_curr 	= mea_opr_ptr.seq_ptr_head  + mea_opr_ptr.act_desc_idx;
				mea_opr_ptr.prev_start_time 	= 0;
				mea_opr_ptr.job_assigned_flag |= TRUE;
				
				opr_ptr.p_other_opr_ptr = &mea_opr_ptr;
				mea_opr_ptr.p_other_opr_ptr = &opr_ptr; /* Add 1127 */
				
				g_op_mea_exe_flag = TRUE;

			}
			
			break;	

		case ACTION_DONE_EVENT: /* Add 1022 */
				
			if( mea_opr_ptr.task_ptr->job_completed_flag == TRUE)
			{
		 		mea_opr_ptr.task_ptr->job_status 			= JOB_READY; 
				mea_opr_ptr.task_ptr->job_completed_flag 	= FALSE;
				mea_opr_ptr.seq_ptr_curr->job_gap_time 	= 0xFFFFFFFF; 	/* 1127 */
//				printf("Q: ACTION_DONE_EVENT : 1 : task_id = %u\n", mea_opr_ptr.task_ptr->task_id);
			}	
			
			if(mea_opr_ptr.act_desc_idx  <  (MEA_SEQ_DESC_IDX_MAX -1) )
			{        
				if( mea_opr_ptr.act_desc_idx  >= (mea_opr_ptr.seq_desc_cnt - 1)  )    /* End of description */
				{
					opr_ptr_init(&mea_opr_ptr);
					g_op_mea_exe_flag = FALSE;
						
//					printf("Q: ACTION_DONE_EVENT : 3: opr_ptr_init()\n");
				}
				else
				{
					mea_opr_ptr.act_desc_idx++;
//					printf("Q: ACTION_DONE_EVENT : 3: act_desc_idx++ = %u\n", mea_opr_ptr.act_desc_idx);
				}
				
			}
			
			break;	

		case ACTION_TRIGGER_EVENT: /* Add 1022 */
			
			if(mea_opr_ptr.seq_ptr_curr != NULL)
			{
				if(mea_opr_ptr.act_desc_idx  <  (MEA_SEQ_DESC_IDX_MAX -1) )
				{        
					if(  mea_opr_ptr.act_desc_idx  < mea_opr_ptr.seq_desc_cnt ) 		/* Exist next description */
					{
						mea_opr_ptr.seq_ptr_curr = mea_opr_ptr.seq_ptr_head  + mea_opr_ptr.act_desc_idx;
						mea_opr_ptr.seq_ptr_curr->job_gap_time = 0;

//						printf("Q: ACTION_TRIGGER_EVENT: OK : act_desc_idx = %u, task_id = %u \n", mea_opr_ptr.act_desc_idx, mea_opr_ptr.task_ptr->task_id);
					}
					else 		/* End of description */
					{
						//opr_ptr_init(&mea_opr_ptr);
//						printf("Q: ACTION_TRIGGER_EVENT : 3: Not Exist \n");
					}				
				}
			}
			
			
			break;	
			
		case OPTIC_TEST_CMD:	

			//g_rountine_cnt = 40;
			//g_rountine_cnt_prev = 0;
			g_optic_test_on_flag = TRUE;
	
			break;

		case OPTIC_TEST1_CMD:

			//g_rountine_cnt = 40;
			//g_rountine_cnt_prev = 0;
			g_optic_test1_on_flag = TRUE;
			
			break;
			
		case OPTIC_TEST2_CMD:

			//g_rountine_cnt = 40;
			//g_rountine_cnt_prev = 0;
			g_optic_test2_on_flag = TRUE;
			
			break;	
			
		default:
			break;
	}
}

/**********************************************************************************
  * @function : task_com_pc
  * @brief :  receive message and enqueue and send message to PC
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_com_pc(void)
{
	uint8_t 	job_item;
	// static  uint8_t	flag = FALSE;

	job_item = msg_parse();

	if(job_item  != 0)
	{
		enqueue_job(job_item);
	}

	if( send1_msg.buf_use_flag == TRUE)
	{
		// TODO: not used?
		usart1_transmit_data(send1_msg.buf, send1_msg.buf_idx);
		send1_msg.buf_use_flag = FALSE;
		printf("task_com_pc : usart1_transmit_data()\n");
	}


}

/**********************************************************************************
  * @function : task_sm1
  * @brief :  step motor 1 task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_sm1(void)
{
	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;

	if(opr_ptr.job_assigned_flag == TRUE)
	{	
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_SM1);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_sm_ops[0] = &this_task;
		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{

					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
					
					/* set action */
					curr_time = get_time_ms_cnt();
								
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;

						/* set timer */
						opr_ptr.prev_start_time = curr_time;

						drv_stepmotor_output_pulse(STEP_MOTOR_1, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);

					}
				}
				break;

			case JOB_RUN:
				break;

			case JOB_DONE:
				
				opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
				this_task.job_completed_flag = TRUE;
				this_seq_desc = NULL;
				break;

			default:
				break;
		}

	}
}

/**********************************************************************************
  * @function : task_sm2
  * @brief :  step motor 2 task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_sm2(void)
{
	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	

	if(opr_ptr.job_assigned_flag == TRUE)
	{		
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_SM2);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_sm_ops[1] = &this_task;

		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{
				
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
					
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;

						/* set step */
						drv_stepmotor_output_pulse(STEP_MOTOR_2, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);
					}
				}
				break;

			case JOB_RUN:
				break;

			case JOB_DONE:
				
				opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
				this_task.job_completed_flag = TRUE;
				this_seq_desc = NULL;
				break;

			default:
				break;
		}

	}

}

/**********************************************************************************
  * @function : task_sm3
  * @brief :  step motor 3 task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_sm3(void)
{
	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	

	if(opr_ptr.job_assigned_flag == TRUE)
	{	
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_SM3);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_sm_ops[2] = &this_task;

		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{
				
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
					
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;

						drv_stepmotor_output_pulse(STEP_MOTOR_3, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);
					}
				}
				break;

			case JOB_RUN:
				break;

			case JOB_DONE:
				
				opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
				this_task.job_completed_flag = TRUE;
				this_seq_desc = NULL;
				break;

			default:
				break;
		}

	}

}

/**********************************************************************************
  * @function : task_sm4
  * @brief :  step motor 4 task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_sm4(void)
{

	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	static uint8_t flag = 0;

	uint32_t check_time = 0;		//201202 test

	if(opr_ptr.job_assigned_flag == TRUE)
	{
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_SM4);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_sm_ops[3] = &this_task;

		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
					
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;

						drv_stepmotor_output_pulse(STEP_MOTOR_4, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);
					}
				}
				else if(g_op_mea_exe_flag == TRUE)
				{
					if( mea_opr_ptr.seq_ptr_curr->task_id == this_task.task_id) 
					{
						/* get sequence description */
						this_seq_desc = mea_opr_ptr.seq_ptr_curr;
									
						/* set action */
						curr_time = get_time_ms_cnt();
						//printf("SM4: m?\n");

						if( (curr_time - mea_opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
						{
							this_task.job_status = JOB_RUN;
							mea_opr_ptr.task_ptr = &this_task;
							
							/* set timer */
							mea_opr_ptr.prev_start_time  = curr_time;

//							check_time = get_time_ms_cnt();		//201202 test
//							printf("SM4: start time: %d\n", check_time);

							drv_stepmotor_output_pulse(STEP_MOTOR_4, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);
							//printf("SM4: m\n");
						}
					}
				}
				else
				{}
				break;

			case JOB_RUN:
				#if 0			
			/* EVENT Test : 1121 */
			if(flag == FALSE)
			{
				set_event( MEASURE_OP_EVENT );
				set_event( ACTION_TRIGGER_EVENT );
				flag = TRUE;
				printf("SM4: event= MEASURE_OP_EVENT,event= ACTION_TRIGGER_EVENT\n");
			}
	#endif	
				break;

			case JOB_DONE:
				
				if(g_op_mea_exe_flag == TRUE)
				{
					mea_opr_ptr.seqact_compl_flags[ mea_opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;

					if(mea_opr_ptr.seq_ptr_curr->direction == UP)
					{
						set_event( ACTION_DONE_EVENT );
						set_event( ACTION_TRIGGER_EVENT );
					}
					else if(mea_opr_ptr.seq_ptr_curr->direction == DOWN)
					{
						set_event( ACTION_DONE_EVENT );
					}
//					set_event( ACTION_DONE_EVENT );
//					set_event( ACTION_TRIGGER_EVENT );
					//printf("OM: event = ACTION_DONE_EVENT, event = ACTION_TRIGGER_EVENT \n");
				}
				else
				{
					opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;
					flag = FALSE;
				}

//				check_time = get_time_ms_cnt();		//201202 test
//				printf("SM4: Finish time: %d\n", check_time);
			break;
			
			default:
				break;
		}
	}
}


/**********************************************************************************
  * @function : task_sm5
  * @brief :  step motor 5 task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_sm5(void)
{

	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	

	if(opr_ptr.job_assigned_flag == TRUE)
	{
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_SM5);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_sm_ops[4] = &this_task;

		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
					
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;

						drv_stepmotor_output_pulse(STEP_MOTOR_5, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed, this_seq_desc->config);
					}
				}
				break;

			case JOB_RUN:
				break;

			case JOB_DONE:
				
				opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
				this_task.job_completed_flag = TRUE;
				this_seq_desc = NULL;
			//	flag = FALSE;
				
				break;

			default:
				break;
		}
	}
}

/**********************************************************************************
  * @function : task_om
  * @brief :  oriental motor  task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_om(void)
{

	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	
	uint32_t check_time = 0;


	if(opr_ptr.job_assigned_flag == TRUE)
	{
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_OM);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_om_ops = &this_task;
		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id)
				{
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
								
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;

						drv_orientalmotor_output_pulse(ORIENTAL_MOTOR, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed);
#if 0	//cartridge check sensor flag
						if(((this_seq_desc->direction == 1) && (this_seq_desc->goal_value == 1500)) || ((this_seq_desc->direction == 0) && (this_seq_desc->goal_value == 750)))
						{
							g_chamber_check_flag = TRUE;
							tube_sensor = DETATCHED;
							basket_sensor = DETATCHED;
						}
#endif
#if 1		/* test add 201013 */
						if((g_cw_flag == TRUE) || (g_ccw_flag == TRUE))
						{
							g_cw_flag = FALSE;
							g_ccw_flag = FALSE;
						}

						if((this_seq_desc->direction == 1))
						{
							g_ccw_flag = TRUE;
						}
						else if((this_seq_desc->direction == 0))
						{
							g_cw_flag = TRUE;
						}
						else
						{}
#endif
					}
				}
				else if( g_op_mea_exe_flag == TRUE)
				{
					//printf("OM: JOB_READY \n");
				
					if( mea_opr_ptr.seq_ptr_curr->task_id == this_task.task_id) 
					{
						
						/* get sequence description */
						this_seq_desc = mea_opr_ptr.seq_ptr_curr;
									
						/* set action */
						curr_time = get_time_ms_cnt();
						//printf("OM: m?\n");
						
						if( (curr_time - mea_opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
						{
							this_task.job_status = JOB_RUN;
							mea_opr_ptr.task_ptr = &this_task;
							
							/* set timer */
							mea_opr_ptr.prev_start_time  = curr_time;

//							check_time = get_time_ms_cnt();		//201202 test
//							printf("OM: start time: %d\n", check_time);

							drv_orientalmotor_output_pulse(ORIENTAL_MOTOR, this_seq_desc->direction, this_seq_desc->goal_value, this_seq_desc->move_speed); 
							//printf("OM: m\n");
						}
					}

				}
				else
				{
					;
				}
				break;

			case JOB_RUN:
				break;

			case JOB_DONE:
#if 0
				if(this_seq_desc->direction == 1)		// bjk 191029	ccw
				{
					om_curr_position += om_final_count;
					//printf("OM position : %d \n", om_curr_position);
				}
				else if(this_seq_desc->direction == 0)	// cw
				{
					om_curr_position -= om_final_count;
					//printf("OM position : %d \n", om_curr_position);
				}
				else if(GPIO_ReadInputDataBit(GPIOC, GPIO_Pin_15) == 0)
				{
					//printf("OM move count : %d \n", om_move_count);
					om_curr_position = 0;
				}
				else
				{}
#endif


				if(g_op_mea_exe_flag == TRUE)
				{
					mea_opr_ptr.seqact_compl_flags[ mea_opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;
					set_event( ACTION_DONE_EVENT );
					set_event( ACTION_TRIGGER_EVENT );
					//printf("OM: event = ACTION_DONE_EVENT, event = ACTION_TRIGGER_EVENT \n");
				}
				else
				{
					opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;
				}
				
//				check_time = get_time_ms_cnt();		//201202 test
//				printf("OM: start time: %d\n", check_time);

				break;

			default:
				break;
		}
	}
}

/**********************************************************************************
  * @function : task_pel
  * @brief :  peltier task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
extern float thermo_temp[2];
extern st_Peltier peltctrl;
void task_pel(void)
{
	float AD_value;
	u8 data8= 0;
	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	static uint8_t flag = 0;
	static uint16_t cnt = 0;
	uint32_t* ptmp;
	uint8_t data = 0;
	static uint8_t test_flag = FALSE;
	static uint8_t opration_start_flag = FALSE; /* Add 1119 */

	static uint8_t time_flag3 = FALSE;
	static uint8_t time_flag4 = FALSE;
	static uint32_t ms_cnt1 = 0;
	static uint32_t ms_cnt2 = 0;
	float setPoint;
	
	cnt++;
	#if 1
	// TEST TEST
	if( (cnt %10) == 0)
	{
		// peltier_get_tempearture();
		peltier_get_tempearture_2();

		printf("%s, %d.%s,",system_elapsedTime(), (int)thermo_temp[0], sub_three(thermo_temp[0]));
		printf(" %d.%s,",(int)thermo_temp[1], sub_three(thermo_temp[1]));
		printf(" %d, %d%%\n", (int)peltctrl.setpoint, peltctrl.pwm.pwm_high);
		//printf("pel> Cycle done\n");
		//printf("g_rountine_cnt = %d\n", (int)g_rountine_cnt);
	}
	#endif

	if(opr_ptr.job_assigned_flag == TRUE)
	{
		if( this_task.init_flag == FALSE)
		{
			p_task_desc_tmp = get_taskDesc(TASKID_PEL);
			this_task.init_flag = TRUE;
			this_task.task_id = p_task_desc_tmp->task_id;
			p_task_pel_ops = &this_task;
			opration_start_flag = FALSE;
//			printf("pel> init..\n");
		}
			
		switch( this_task.job_status )
		{
			case JOB_READY:

				if( opr_ptr.seq_ptr_curr->task_id == this_task.task_id) 
				{
					if(opration_start_flag == FALSE)
					{
						/* get sequence description */
						this_seq_desc = opr_ptr.seq_ptr_curr;
						
						/* set action */
						curr_time = get_time_ms_cnt();
					
						if( (curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
						{
							opr_ptr.task_ptr = &this_task;
							
							/* set timer */
							opr_ptr.prev_start_time  = curr_time;

							opration_start_flag = TRUE;
							printf("PEL : opr_ptr \n");
/*
							printf("PRE_COND_SETPOINT= %d\n", (int)g_PRE_COND_SETPOINT);
							printf("1st_STEP_SETPOINT= %d\n", (int)g_HEAT_SETPOINT);
							printf("2nd_STEP_SETPOINT= %d\n", (int)g_COOL_SETPOINT);
*/
							float a,b;
							a = drv_mcp9600_read_temp(ADDR_COLD_JUNCTION_TEMP_REG);
							b = drv_mcp9600_2_read_temp(ADDR_COLD_JUNCTION_TEMP_REG);

							printf("[Cold] %d.%s,", (int)a, sub_three(a));
							printf(" %d.%s\n",(int)b, sub_three(b));
						}
					}

					if( opration_start_flag == TRUE)
					{
						#if 0
						/* EVENT Test : 1022 */
						if(flag == FALSE)
						{
							set_event( MEASURE_OP_EVENT );
							set_event( ACTION_TRIGGER_EVENT );
							flag = TRUE;
							//printf("PEL: event= MEASURE_OP_EVENT,event= ACTION_TRIGGER_EVENT\n");
						}
						#endif
						
						if(peltier_ctrl_pre_cond( g_RT_PRE_COND_SETPOINT,  MINUTE_UNIT * g_RT_Keeping_Minute_Peltier_Temperature ) == TRUE) 	/* 10s */
						//if( peltier_pwm_test( 100,  MINUTE_UNIT * 5 ) == TRUE )	
						{
							this_task.job_status = JOB_RUN;
							peltier_step = PRE_COND_STEP;
							
							printf("PEL: JOB_READY\n");
						#if 0
							g_temp_data_flag = FALSE;
							peltier_print2(1); //TEST : 1104
							delay(3000);
							
							peltier_print2(2); //TEST : 1104
							delay(4000);
							
							//peltier_data_init();
							//delay(3000);
						#endif	
							
						}
					}
				}
				else if( (g_op_mea_exe_flag == TRUE) && ( mea_opr_ptr.seq_ptr_curr->task_id == this_task.task_id)  )
				{
					if(opration_start_flag == FALSE)
					{
						/* get sequence description */
						this_seq_desc = mea_opr_ptr.seq_ptr_curr;
						
						/* set action */
						curr_time = get_time_ms_cnt();
					
						if( (curr_time - mea_opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
						{
							mea_opr_ptr.task_ptr = &this_task;
							
							/* set timer */
							mea_opr_ptr.prev_start_time  = curr_time;

							opration_start_flag = TRUE;
							printf("PEL: mea_opr_ptr \n");
						}
					}

					if( opration_start_flag == TRUE)
					{										
						if(peltier_ctrl_pre_cond( g_RT_PRE_COND_SETPOINT,  MINUTE_UNIT * g_RT_Keeping_Minute_Peltier_Temperature ) == TRUE) 	/* 10s */
						//if( peltier_pwm_test( 100,  MINUTE_UNIT * 5 ) == TRUE )	
						{
							this_task.job_status = JOB_RUN;
							peltier_step = PRE_COND_STEP;
							printf("PEL:  peltier_ctrl_pre_cond  \n");
						}
					}
				}
				else
				{
					;
				}
	
				break;

			case JOB_RUN:
				
				switch(peltier_step)
				{
					case PRE_COND_STEP:

						if((error_msg_flag == TRUE) || (temp_err_stop_flag == TRUE))		/* door safety test 0417, temp read error 210205 */
						{
							break;
						}

						setPoint = peltier_delayed_SetPoint(g_PRE_COND_SETPOINT, OVERSHOOT_OFFSET, MINUTE_UNIT  * 4); //[4]// SECOND_UNIT*20
						if(peltier_ctrl_pre_cond( setPoint, MINUTE_UNIT * g_Keeping_Minute_Peltier_Temperature  ) == TRUE)  //[7] // @@@ setPoint: ����Ŭ �� precondition ���� �µ� ���ð� ����
						//if(peltier_ctrl_pre_cond( PRE_COND_SETPOINT,  MINUTE_UNIT  * 1   ) == TRUE)  /* 1min */							// @@@ MINUTE_UNIT: ����Ŭ �� precondition ���� �����ð� ���ð�
					//	if( peltier_pwm_test( 80,  MINUTE_UNIT * 5 ) == TRUE )	
			               	//	if(peltier_ctrl_pre_cond_cooling( READY_SETPOINT, MINUTE_UNIT  * 2 ) == TRUE) 
						//drv_peltier_fan_blow(ON);	
						{
							peltier_step = CYCLE_STEP;
							peltier_delayed_reset();
							g_temp_data_flag = FALSE;
							
							printf("PEL:  peltier_ctrl_pre_cond 2 \n");
							//g_print_flag = TRUE;
							
							//peltier_print(1); //TEST : 1104
							//delay(3000);
							
							//peltier_print(2); //TEST : 1104
							//delay(5000);
							//peltier_data_init();
						}
						break;
						
					case CYCLE_STEP:

						if((error_msg_flag == TRUE) || (temp_err_stop_flag == TRUE))		/* door safety test 0417, temp read error 210205 */
						{
							break;
						}

						if(peltier_ctrl_cycle_routine() == TRUE)
						//if(peltier_ctrl_pre_cond_cooling( READY_SETPOINT, SECOND_UNIT  * 20 ) == TRUE) 
						{
							peltier_step = PRE_COND_STEP;
							this_task.job_status = JOB_DONE;
							printf("pel> Cycle done\n");
							//peltier_print(1); //TEST : 1104
							//delay(5000);	
							//peltier_print(2); //TEST : 1104
							//delay(5000);
						}
						break;
						
					default:
						break;
						
				}

				
				break;

			case JOB_DONE:
				
				if(g_op_mea_exe_flag == TRUE)
				{
					mea_opr_ptr.seqact_compl_flags[ mea_opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;
					set_event( ACTION_DONE_EVENT );
//					set_event( ACTION_TRIGGER_EVENT );
					//printf("PEL: event = ACTION_DONE_EVENT, event = ACTION_TRIGGER_EVENT \n");
				}
				else
				{
					opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;
					this_task.job_status = JOB_NONE; 		/* Add 0917 */
					opration_start_flag = FALSE;			/* Add 1119 */
					drv_water_fan(OFF);	/* 210114 test */
#if AGEING_TEST
					infinity_start_stop_flag = TRUE;	/*test 0323*/
#endif
				}
				break;

			default:
			//	peltier_ctrl_pre_cond( READY_SETPOINT, 4294967290 ); /* Add 0917 */
				break;
		}
	}
	else
	{
		//peltier_ctrl_pre_cond( READY_SETPOINT ); /* Add 0917 */
	}

}


/**********************************************************************************
  * @function : task_opt
  * @brief :  optic device task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
#define OPT2_DELAY_MS	0//1200
void task_opt(void)
{
//	uint16_t func_code;
//	uint16_t  start_reg;
//	uint16_t num_or_val;
//	static uint8_t test_flag = 0;
	static uint16_t cnt = 0;
	stTaskType* 	p_task_desc_tmp;
	static stTaskOp  this_task = {0,0,0,JOB_READY,0,0,0,0,0,0};
	static stSeqDesc*	this_seq_desc = NULL;
	uint32_t	curr_time = 0;
	uint8_t mea_kind = 0;
	uint32_t chamber_no;
	uint8_t chamber_no_opt2;

	uint32_t check_time = 0;	//201202 test

	cnt++;

	if( g_fluosens_setting_flag != TRUE)
	{
		g_fluosens_setting_flag = TRUE;
		optic_qiagen_task_init();
	}
	else
	{
		if( (opr_ptr.job_assigned_flag == TRUE) || (( g_optic_test1_on_flag == TRUE) ||( g_optic_test2_on_flag == TRUE)) )
		{
			if( this_task.init_flag == FALSE)
			{
				p_task_desc_tmp = get_taskDesc(TASKID_OPT);
				this_task.init_flag = TRUE;
				this_task.task_id = p_task_desc_tmp->task_id;
				p_task_opt_ops = &this_task; 
			}
		}

		switch( this_task.job_status )
		{
			case JOB_READY:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( (opr_ptr.seq_ptr_curr->task_id == this_task.task_id) || ( ( g_optic_test1_on_flag == TRUE) ||( g_optic_test2_on_flag == TRUE)) )
				{
					/* get sequence description */
					this_seq_desc = opr_ptr.seq_ptr_curr;
								
					/* set action */
					curr_time = get_time_ms_cnt();
					
					if( ((curr_time - opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time) ||
							(( g_optic_test1_on_flag == TRUE) ||( g_optic_test2_on_flag == TRUE))  )
					{
						this_task.job_status = JOB_RUN;
						opr_ptr.task_ptr = &this_task;
						
						/* set timer */
						opr_ptr.prev_start_time  = curr_time;
//						printf("OPT\n");
						optic_qiagen_measure_ready();
					}
				}
				else if(g_op_mea_exe_flag == TRUE) 
				{
					if( mea_opr_ptr.seq_ptr_curr->task_id == this_task.task_id)  
					{							
						/* get sequence description */
						this_seq_desc = mea_opr_ptr.seq_ptr_curr;
									
						/* set action */
						curr_time = get_time_ms_cnt();
						//printf("OPT: m?\n");
						
						if((curr_time - mea_opr_ptr.prev_start_time ) >= this_seq_desc->job_gap_time)
						{
							this_task.job_status = JOB_RUN;
							mea_opr_ptr.task_ptr = &this_task;
							
							/* set timer */
							mea_opr_ptr.prev_start_time  = curr_time;

//							check_time = get_time_ms_cnt();		//201202 test
//							printf("OPT: start time: %d\n", check_time);
							optic_qiagen_measure_ready();
						}
					}
				}
				else
				{
					;
				}

				break;

			case JOB_RUN:
				if(error_msg_flag == TRUE)		/* door safety test 0417 */
				{
					break;
				}

				if( (g_optic_test1_on_flag == TRUE)|| (g_optic_test2_on_flag ==TRUE ) ) 	/* Add 1205 */
				{
					chamber_no = 1;
				}
				else
				{
					if(g_op_mea_exe_flag == TRUE) 
					{
						chamber_no = mea_opr_ptr.seq_ptr_curr->goal_value;
					}
					else
					{
						chamber_no = this_seq_desc->goal_value;
					}
				}
#if 0	//Ver1.0 chamber
				if(chamber_no <3 )
				{
					chamber_no_opt2 = chamber_no + 2;
				}
				else if(chamber_no >=3)
				{
					chamber_no_opt2 = chamber_no - 2;
				}
				else
				{}
#endif
#if 1	//Ver2.0 chamber
				g_optic1_tube_no = chamber_no;
				if(chamber_no < 4 )
				{
					chamber_no_opt2 = chamber_no + 1;
					g_optic2_tube_no = chamber_no_opt2;
				}
				else if(chamber_no >= 4)
				{
					chamber_no_opt2 = chamber_no - 3;
					g_optic2_tube_no = chamber_no_opt2;
				}
				else
				{}
#endif
				int16_t is_measure_done = 0;

				if(g_optic_test1_on_flag == TRUE)
				{
					if(optic_qiagen_measure_process(MODBUS_PORT1, chamber_no, 0) == TRUE)
					{
						this_task.job_status = JOB_DONE;
						g_optic_test1_on_flag = FALSE;
					}
				}
				else if(g_optic_test2_on_flag == TRUE)
				{
					if(optic_qiagen_measure_process(MODBUS_PORT2, chamber_no_opt2, 0) == TRUE)
					{
						this_task.job_status = JOB_DONE;
						g_optic_test2_on_flag = FALSE;
					}
				}
				else
				{
					if(optic_qiagen_measure_process(MODBUS_PORT1, chamber_no, 0) == TRUE)
					{
						is_measure_done++;
					}

					if(optic_qiagen_measure_process(MODBUS_PORT2, chamber_no_opt2, OPT2_DELAY_MS) == TRUE)
					{
						is_measure_done++;
					}

					if(is_measure_done >=2)
					{
						this_task.job_status = JOB_DONE;
					}
				}

				break;

			case JOB_DONE:
				
				if(g_op_mea_exe_flag == TRUE) // @@@@
				{
					mea_opr_ptr.seqact_compl_flags[ mea_opr_ptr.act_desc_idx ] = TRUE;
					this_task.job_completed_flag = TRUE;
					this_seq_desc = NULL;

					mea_kind = optic_qiagen_check_msg(); 
					printf("OPT: mea_kind = %u\n", mea_kind);
					
					if( ( mea_kind == OPT_MEA)  || ( mea_kind == BASE_OPT_MEA) || ( mea_kind == CYCLE_OPT_MEA) ) /* check the data sent or not to pc */	/* Mod 1209 */
					{
						// optic_send_msg(mea_kind, mea_opr_ptr.seq_ptr_curr->direction, mea_opr_ptr.seq_ptr_curr->goal_value );

						optic_qiagen_send_msg(MODBUS_PORT1, mea_kind, QIA_E1D1_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value);
						optic_qiagen_send_msg(MODBUS_PORT1, mea_kind, QIA_E2D2_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value);
//Ver2.0
						if(mea_opr_ptr.seq_ptr_curr->goal_value < 4 )
						{
							optic_qiagen_send_msg(MODBUS_PORT2, mea_kind, QIA_E1D1_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value+1);
							optic_qiagen_send_msg(MODBUS_PORT2, mea_kind, QIA_E2D2_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value+1);
						}
						else if(mea_opr_ptr.seq_ptr_curr->goal_value >= 4)
						{
							optic_qiagen_send_msg(MODBUS_PORT2, mea_kind, QIA_E1D1_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value-3);
							optic_qiagen_send_msg(MODBUS_PORT2, mea_kind, QIA_E2D2_MDOE, mea_opr_ptr.seq_ptr_curr->goal_value-3);
						}
						else
						{}
//						printf("OPT: mea_kind = OPT_MEA : SEND MSG\n");
					}
					
					if( mea_opr_ptr.seq_ptr_curr->config == DIS_CONT )	
					{
						set_event( ACTION_DONE_EVENT );
						set_event( ACTION_TRIGGER_EVENT );
//						printf("OPT: event = ACTION_DONE_EVENT:     DIS_CONT\n");
						if(mea_kind == CYCLE_OPT_MEA)	//200728 test
						{
							optic_cycle_data_init();
						}

						if(g_rountine_cnt == 45)
						{
							printf("g_end_process");
						}
					}
					else
					{
						set_event( ACTION_DONE_EVENT );
						set_event( ACTION_TRIGGER_EVENT );
//						printf("OPT: event = ACTION_DONE_EVENT, event = ACTION_TRIGGER_EVENT : CONT\n");
					}
				}
				else
				{
					if( (g_optic_test1_on_flag == TRUE)|| (g_optic_test2_on_flag ==TRUE ) ) 	/* Add 1205 */
					{
						this_task.job_status = JOB_READY;
					}
					else
					{
						opr_ptr.seqact_compl_flags[ opr_ptr.act_desc_idx ] = TRUE;
						this_task.job_completed_flag = TRUE;
						this_seq_desc = NULL;
					}
				}
//				check_time = get_time_ms_cnt();		//201202 test
//				printf("OPT: finish time: %d\n", check_time);
				break;

			default:
				break;
		}

	}

	optic_qiagen_msg_process();
}

/**********************************************************************************
  * @function : task_manage
  * @brief :  task manager task
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void task_manage(void)
{
   	uint32_t tmp;

	if(opr_ptr.job_assigned_flag != TRUE)
	{
		return ;
	}
	
	
	if( opr_ptr.task_ptr->job_completed_flag == TRUE)
	{
 		opr_ptr.task_ptr->job_status = JOB_READY;
		opr_ptr.task_ptr->job_completed_flag = FALSE;

		if(opr_ptr.act_desc_idx  <  (SEQ_DESC_IDX_MAX -1) )
		{
			opr_ptr.act_desc_idx++;
			opr_ptr.seq_ptr_curr = opr_ptr.seq_ptr_head  + opr_ptr.act_desc_idx;
		}
	}

	if(check_seq_compl() == TRUE)
	{
		opr_ptr.seq_compld_flag = TRUE;
		//printf(" All Job Partially Completed\n");
		
		if(opr_ptr.p_other_opr_ptr == NULL)  /* if other description is completed */
		{
			opr_ptr.job_assigned_flag = FALSE;
//200713block			g_op_exe_flag = FALSE;	/* Add 1205 */
			//printf(" All Job Completed\n");
		}
	}
	
}


/**********************************************************************************
  * @function : check_seq_compl
  * @brief :  check sequence completed or not
  * @note :
  * @param : void
  * @retval : true or false
  *********************************************************************************/
uint8_t check_seq_compl(void)
{
	uint16_t i;
	uint8_t rslt = TRUE;

	for(i = 0; i <  opr_ptr.seq_desc_cnt  ; i++)		
	{
		if( opr_ptr.seqact_compl_flags[i] != TRUE )
		{
			rslt = FALSE;
			break;
		}
	}

	return rslt;
}


/**********************************************************************************
  * @function : enqueue_job
  * @brief :  enqueue job to the queue
  * @note :
  * @param : enq_data
  * @retval : None
  *********************************************************************************/
void enqueue_job(uint8_t enq_data)
{
//	uint16_t 	i;

	job_queue.q_buf[job_queue.tail_ptr] = enq_data;
	
	if( job_queue.tail_ptr == (Q_BUF_MAX-1) )
	{
		job_queue.tail_ptr = 0;
	}
	else
	{
		job_queue.tail_ptr++;
	}
}

/**********************************************************************************
  * @function : dequeue_job
  * @brief :  dequeue job from the queue
  * @note :
  * @param : void
  * @retval : job
  *********************************************************************************/
uint8_t dequeue_job(void)
{
	uint8_t ret_data = 0;
	uint8_t ret_flag = FALSE;
//	uint16_t	i;
	

	if( job_queue.head_ptr != job_queue.tail_ptr) 	/* Empty Check */
	{
		ret_data = job_queue.q_buf[job_queue.head_ptr];
		job_queue.q_buf[job_queue.head_ptr] = 0;
		
		if( job_queue.head_ptr == (Q_BUF_MAX-1) )
		{
			job_queue.head_ptr = 0;
		}
		else
		{
			job_queue.head_ptr++;
		}
		ret_flag = TRUE;
	}
	else
	{
		ret_flag = FALSE;
	}


	if(ret_flag == TRUE)
	{
		return ret_data;
	}
	else
	{
		return ret_flag;
	}
	
}

/**********************************************************************************
  * @function : queue_init
  * @brief :  queue initialize
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void queue_init(void)
{
	uint16_t i;

	job_queue.head_ptr = job_queue.tail_ptr = 0;

	for(i = 0;i < Q_BUF_MAX; i++)
	{
		job_queue.q_buf[i] = 0;
	}
}


/**********************************************************************************
  * @function : msg_parse
  * @brief :   parsing the message from PC
  * @note :
  * @param : void
  * @retval : command id
  *********************************************************************************/
void Check_Glob_Var(char *, int szmsg);
uint8_t msg_parse(void)
{
	uint8_t job_msg_data = 0;
	uint8_t* p_data;
	uint8_t buf[20] = {0};
	uint8_t buf2[20] = {0};
	uint8_t i;
	uint8_t idx;
	
	uint8_t ii;

	if(recv1_msg.buf_use_flag == TRUE) // @@@ PC ==> MCU string.
	{
		idx = recv1_msg.buf_idx - 3;
		memcpy( buf, &recv1_msg.buf[1], idx);
		buf[idx] = '\0';	
		recv1_msg.buf_use_flag = FALSE;
		
		//for(ii=0; ii<40; ii++)
		//{
		//	printf("%02X\n", recv1_msg.buf[ii]);
		//}


		//printf("Call Check_Glob_Var()...\n");
		Check_Glob_Var(buf, idx);

		//if(strcmp(buf, "SHOW_GLOB_VARS")==0)
		//{
		//	printf("SHOW_GLOB_VARS\n");
			//Print_Glob_Vars();
		//}

		if( strcmp( buf, "start") == 0)
		{
			job_msg_data = START_CMD;
		}
		else if( strcmp( buf, "stop") == 0)
		{
			job_msg_data = STOP_CMD;
		}
		else if( strcmp( buf, "optic1") == 0)
		{
			job_msg_data = OPTIC_TEST1_CMD;
		}
		else if( strcmp( buf, "optic2") == 0)
		{
			job_msg_data = OPTIC_TEST2_CMD;
		}
		else if( strcmp( buf, "forceFan") == 0)
		{
			printf("forece fan\n");
			drv_peltier_fan_blow(ON);
			drv_water_fan(ON);
		}
		else if( strcmp( buf, "FanOff") == 0)
		{
			printf("fan off\n");
			drv_peltier_fan_blow(OFF);
			drv_water_fan(OFF);
			// optic_qiagen_test();		// TEST TEST
		}
		else if( strcmp( buf, "optRead1") == 0)
		{
			optic_qiagen_read_all(MODBUS_PORT1);
		}
		else if( strcmp( buf, "optRead2") == 0)
		{
			optic_qiagen_read_all(MODBUS_PORT2);
		}
		else if( strcmp( buf, "readTemp") == 0)
		{
			peltier_get_tempearture();
			peltier_get_tempearture_2();
			
			printf("[Hot] %d.%s,", (int)thermo_temp[0],sub_three(thermo_temp[0]));
			printf(" %d.%s\n",(int)thermo_temp[1],sub_three(thermo_temp[1]));

			// float a, b;

			// a = drv_mcp9600_read_temp(ADDR_HOT_JUNCTION_TEMP_REG);
			// b = drv_mcp9600_2_read_temp(ADDR_HOT_JUNCTION_TEMP_REG);

			// printf("[Hot] %d.%s,", (int)a, sub_three(a));
			// printf(" %d.%s\n",(int)b, sub_three(b));

			// a = drv_mcp9600_read_temp(ADDR_COLD_JUNCTION_TEMP_REG);
			// b = drv_mcp9600_2_read_temp(ADDR_COLD_JUNCTION_TEMP_REG);

			// printf("[Cold] %d.%s,", (int)a, sub_three(a));
			// printf(" %d.%s\n",(int)b, sub_three(b));
		}
		/*
			example: SM1020000800 ( motor number[SM1~5], direction[0,1], pulse count[0000~9999], pulse period[0000~9999])
		*/
		else if(( buf[0] == 'S') && (buf[1] =='M') && (strlen(buf) == 12))
		{
			char num[4];
			int sm = atoh(buf[2]);
			int dir = atoh(buf[3]);
			int count = 0;
			int period = 0;

			for(int i=0;i<4;i++)
			{
				num[i] = atoh(buf[i+4]);
				if(num[i] != 0 )
				{
					count += num[i] * times10(3-i);
				}
			}

			for(int i=0;i<4;i++)
			{
				num[i] = atoh(buf[i+8]);
				if(num[i] != 0 )
				{
					period += num[i] * times10(3-i);
				}
			}

//			printf("SM[%d], %d, %d ,%d\n", sm, dir, count, period);

			if(dir != 0)
			{
				if(drv_stepmotor_check_sensor(sm) == FALSE)
				{
					drv_stepmotor_output_pulse(sm, dir, count, period, 0);
				}
			}
			else
			{
				drv_stepmotor_output_pulse(sm, dir, count, period, 0);
			}
			
		}
		else if(( buf[0] == 'O') && (buf[1] =='M') && (strlen(buf) == 12))
		{
			char num[4];
			int om = atoh(buf[2]);
			int dir = atoh(buf[3]);
			int count = 0;
			int period = 0;

			for(int i=0;i<4;i++)
			{
				num[i] = atoh(buf[i+4]);
				if(num[i] != 0 )
				{
					count += num[i] * times10(3-i);
				}
			}

			for(int i=0;i<4;i++)
			{
				num[i] = atoh(buf[i+8]);
				if(num[i] != 0 )
				{
					period += num[i] * times10(3-i);
				}
			}

//			printf("OM[%d], %d, %d ,%d\n", om, dir, count, period);
			drv_orientalmotor_output_pulse(om, dir, count, period);
		}
		/*
		 	 example: QIA R 0 2 0102 0000 ( read or write[R, W], port[0,1], len[1,2 byte], start reg[0x0000~0xFFFF], value[0x0000~0xFFFF])
		 */
		else if(( buf[0] == 'Q') && (buf[1] =='I') && (buf[2] =='A') && (strlen(buf) == 14))
		{
			if(buf[3] == 'R')
			{
				char num[4];
				uint8_t port = atoh(buf[4]);
				uint8_t len = atoh(buf[5]);
				int byteNum;
				uint16_t reg, value;
				uint8_t fail_flag = FALSE;

				for(int i=0;i<2;i++)
				{
					byteNum = ahtob(&buf[i*2+6]);
					if(byteNum >= 0 )
					{
						num[i] = byteNum;
					}
					else
					{
						fail_flag = TRUE;
					}
				}
				reg = (num[0]<<8) | num[1];

				for(int i=0;i<2;i++)
				{
					byteNum = ahtob(&buf[i*2+10]);
					if(byteNum >= 0 )
					{
						num[i] = byteNum;
					}
					else
					{
						fail_flag = TRUE;
					}
				}
				value = (num[0]<<8) | num[1];

				if(fail_flag != TRUE)
				{
					mod_send(port, FUNC_READING, reg, len);
				}
			}
		}
		else
		{
			job_msg_data = 0;
		}
	}

	
	return job_msg_data;
}


/**********************************************************************************
  * @function : update_sm_status
  * @brief : update step motor status
  * @note :
  * @param : channel, status
  * @retval : eJobStatus
  *********************************************************************************/
eJobStatus update_sm_status(uint8_t ch, eJobStatus status)
{
	eJobStatus ret = JOB_NONE;
	// printf("sm[%d] st= %d\n", ch, status);

	switch(ch)
	{
		case 1:
			if(p_task_sm_ops[0]->job_status == JOB_RUN)
			{
				p_task_sm_ops[0]->job_status = status;
				ret = status;
			}
			break;

		case 2:
			if(p_task_sm_ops[1]->job_status == JOB_RUN)
			{
				p_task_sm_ops[1]->job_status = status;
				ret = status;
			}
			break;
			
		case 3:
			if(p_task_sm_ops[2]->job_status == JOB_RUN)
			{
				p_task_sm_ops[2]->job_status = status;
				ret = status;
			}
			break;
		
		case 4:
			if(p_task_sm_ops[3]->job_status == JOB_RUN)
			{
				p_task_sm_ops[3]->job_status = status;
				ret = status;
			}
			break;

		case 5:
			if(p_task_sm_ops[4]->job_status == JOB_RUN)
			{
				p_task_sm_ops[4]->job_status = status;
				ret = status;
			}
			break;	
			
		default:
			break;
	}
	
	return ret;
}


/**********************************************************************************
  * @function : update_om_status
  * @brief :  update oriental motor status
  * @note :
  * @param : status
  * @retval : eJobStatus ret
  *********************************************************************************/
eJobStatus update_om_status(eJobStatus status) 
{
	eJobStatus ret = JOB_NONE;
	
	// printf("om st= %d\n", status);
	if(p_task_om_ops->job_status == JOB_RUN)
	{
		p_task_om_ops->job_status = status;
		ret = status;
	}
	return ret;
}



void delay(u16 x)
{
	volatile u16 i ;
	for(i = 0; i < x; i++)
	{
		;
	}
}

/**********************************************************************************
  * @function : callback_opt_status
  * @brief :  callback function of optic status 
  * @note :
  * @param : void
  * @retval : None
  *********************************************************************************/
void callback_opt_status(void)
{

	if(p_task_opt_ops->job_status == JOB_RUN)
	{
		p_task_opt_ops->job_status = JOB_DONE;
	}
}

/**********************************************************************************
  * @function : set_event
  * @brief :  put an event to queue 
  * @note :
  * @param : event
  * @retval : None
  *********************************************************************************/
void set_event(uint8_t evt)
{

	if(evt  != 0)
	{
		enqueue_job(evt);
	}
}


/**********************************************************************************
  * @function : get_seq_cnt
  * @brief :  get the sequence count
  * @note :
  * @param : p_seq_desc
  * @retval : sequenc count
  *********************************************************************************/
  uint16_t get_seq_cnt(stSeqDesc* p_seq_desc) /* Add 1121 */
{
	uint16_t  i;
	uint16_t cnt = 0;
	stSeqDesc seq_desc_tmp;

	for( i = 0; i < 1000; i++)
	{
		seq_desc_tmp = (stSeqDesc)(*(p_seq_desc + i));
		
		if(( seq_desc_tmp.task_id == 0) && (seq_desc_tmp.goal_value == 0))
		{
			break;
		}
		else
		{
			cnt++;
		}
	}
	
	return cnt;
}

/**********************************************************************************
  * @function : opr_ptr_init
  * @brief :  operation pointer initialize
  * @note :
  * @param : ptr
  * @retval : None
  *********************************************************************************/
void opr_ptr_init(stOprInfo* ptr)
{
	if( ptr == (&opr_ptr))
	{
		opr_ptr.seq_ptr_head 	= NULL;
		opr_ptr.seq_ptr_curr 	= NULL;
		opr_ptr.act_desc_idx		= 0;
		opr_ptr.task_id			= TASKID_NONE;
		opr_ptr.task_max		=  (uint8_t)TASKID_MAX -1;
		opr_ptr.regist_task_cnt	= 0;
		opr_ptr.seq_compld_flag	= FALSE;
		memset( &opr_ptr.seqact_compl_flags, 0, SEQ_DESC_IDX_MAX);
		opr_ptr.prev_start_time	= 0;
		opr_ptr.job_assigned_flag	= FALSE;
		opr_ptr.p_other_opr_ptr	= NULL;
		opr_ptr.seq_desc_cnt	= 0;
	}
	else if( ptr == (&mea_opr_ptr))
	{

		mea_opr_ptr.seq_ptr_head 	= NULL;
		mea_opr_ptr.seq_ptr_curr 	= NULL;
		mea_opr_ptr.act_desc_idx		= 0;
		mea_opr_ptr.task_id			= TASKID_NONE;
		mea_opr_ptr.task_max		=  (uint8_t)TASKID_MAX -1;
		mea_opr_ptr.regist_task_cnt	= 0;
		mea_opr_ptr.seq_compld_flag	= FALSE;
		memset( &mea_opr_ptr.seqact_compl_flags, 0, SEQ_DESC_IDX_MAX);
		mea_opr_ptr.prev_start_time	= 0;
		mea_opr_ptr.job_assigned_flag	= FALSE;
		mea_opr_ptr.p_other_opr_ptr	= NULL;
		mea_opr_ptr.seq_desc_cnt	= 0;
	}
	else
	{
		;
	}
}

uint8_t door_sensor_check(void)		/* 0402 door safety sensor code test */
{
	uint8_t ret;

	if(GPIO_ReadInputDataBit(GPIOC, GPIO_Pin_8) == 0)
	{
		door_up_sensor_flag = OPEN;
	}
/*
	if(GPIO_ReadInputDataBit(GPIOC, GPIO_Pin_9) == 1)
	{
		door_down_sensor_flag = OPEN;
	}
*/
	if((door_up_sensor_flag == CLOSE) /*|| (door_down_sensor_flag == CLOSE)*/)
	{
		ret = CLOSE;
	}
	else if((door_up_sensor_flag == OPEN) /*&& (door_down_sensor_flag == OPEN)*/)
	{
		ret = OPEN;
	}
	else
	{
		;
	}

	return ret;
}
#if 1
static uint8_t UV_flag = FALSE;

void drv_UV_LED(uint8_t on_off)
{
	volatile uint32_t time = get_time_ms_cnt();
	static uint32_t since_time;
	uint8_t door_state = door_sensor_check();

	if(door_state == CLOSE)
	{
		if(on_off == ON)
		{
			if(UV_flag == FALSE)
			{
				GPIO_WriteBit(GPIOC, GPIO_Pin_9, ON);
				UV_flag = TRUE;
				since_time = time;
			}
			if((time - since_time) > 10 * MINUTE_UNIT)
			{
				GPIO_WriteBit(GPIOC, GPIO_Pin_9, OFF);
				UV_flag = FALSE;
				on_off = OFF;
			}
		}
	}
	else
	{
		GPIO_WriteBit(GPIOC, GPIO_Pin_9, OFF);
		UV_flag = FALSE;
		on_off = OFF;
		printf("CLOSE_DOOR\n");
	}
}
#endif
